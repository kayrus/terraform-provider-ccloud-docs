<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Terraform by HashiCorp">

    <link rel="apple-touch-icon" sizes="180x180" href="../../../assets/images/favicons/apple-touch-icon-13180a24.png">
    <link rel="icon" type="image/png" href="../../../assets/images/favicons/favicon-32x32-62171ffd.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../../assets/images/favicons/favicon-16x16-2821bcc8.png" sizes="16x16">
    <link rel="manifest" href="/android-manifest.json">
    <link rel="mask-icon" href="../../../assets/images/favicons/safari-pinned-tab-bab846e1.svg" color="#5C4EE5">
    <meta name="msapplication-config" content="/microsoft-tile.xml" />
    <meta name="theme-color" content="#ffffff">
    
      <meta name="twitter:card" content="summary" />
      <meta property="og:image" content="/../../../assets/images/og-image-8b3e4f7d.png"/>
      <meta property="og:image:width" content="100"/>
      <meta property="og:image:height" content="100"/>
    <meta name="twitter:site" content="@HashiCorp" />
    <meta name="twitter:creator" content="@HashiCorp" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="/docs/enterprise/private/migrate.html" />
    <meta property="og:title" content="Private Terraform Enterprise Installer Migration - Terraform by HashiCorp" />
    <meta property="og:site_name" content="Terraform by HashiCorp"/>
    <meta property="og:description" content="Terraform by HashiCorp" />

    <title>Private Terraform Enterprise Installer Migration - Terraform by HashiCorp</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://use.typekit.net/wxf7mfi.css">
    <link href="../../../assets/stylesheets/application-06344df3.css" rel="stylesheet" />

    <!-- Site scripts -->
    <!--[if lt IE 9]><script src="../../../assets/javascripts/ie-compat-c141a02d.js" defer="defer"></script><![endif]-->
    <script src="../../../assets/javascripts/application-e080fe63.js" defer="defer"></script>

    <!-- Analytics scrpts -->
    <script defer>
      !function(){var e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"],e.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),e.push(a),e}};for(var t=0;t<e.methods.length;t++){var a=e.methods[t];e[a]=e.factory(a)}e.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(t,a)},e.SNIPPET_VERSION="4.0.0",e.load("")}}();var om597a24292a958,om597a24292a958_poll=function(){var e=0;return function(t,a){clearInterval(e),e=setInterval(t,a)}}();!function(e,t,a){if(e.getElementById(a))om597a24292a958_poll(function(){if(window.om_loaded&&!om597a24292a958)return(om597a24292a958=new OptinMonsterApp).init({s:"35109.597a24292a958",staging:0,dev:0,beta:0})},25);else{var n=!1,o=e.createElement("script");o.id=a,o.src="//a.optnmstr.com/app/js/api.min.js",o.async=!0,o.onload=o.onreadystatechange=function(){if(!(n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState))try{n=om_loaded=!0,(om597a24292a958=new OptinMonsterApp).init({s:"35109.597a24292a958",staging:0,dev:0,beta:0}),o.onload=o.onreadystatechange=null}catch(e){}},(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}}(document,0,"omapi-script");
    </script>

    
  </head>

  <body id="page-docs-enterprise2-private-installer-migration" class="layout-enterprise2 page-private-terraform-enterprise-installer-migration">

    <svg class="hidden-print" aria-hidden="true" style="position: absolute; width: 0; height: 0;" width="0" height="0" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <symbol id="mega-nav-icon-angle" viewBox="0 0 13 7">
      <polygon points="6.5,6.5 0.7,1.6 1.3,0.8 6.5,5.2 11.7,0.8 12.3,1.6 "/>
    </symbol>
    <symbol id="mega-nav-icon-close" viewBox="0 0 13 15">
      <path vector-effect="non-scaling-stroke" d="M1.1 14L11.9 1M11.9 14L1.1 1"/>
    </symbol>
  </defs>
</svg>
<div class="hidden-print mega-nav-sandbox">
  <div class="mega-nav-banner">
    <div class="container">
      <div class="mega-nav-banner-item">
        <a class="mega-nav-banner-logo" href="https://www.hashicorp.com"><img src="../../../assets/images/mega-nav/logo-hashicorp-wordmark-bbed0e8a.svg" alt="HashiCorp Logo" /></a>
      </div>
      <div class="mega-nav-banner-item">
        <p class="mega-nav-tagline"><span class="visible-xs text-muted">Learn the</span><span class="hidden-xs text-muted">Learn how Terraform fits into the</span></p>
        <div id="#mega-nav" class="mega-nav">
          <button type="button" id="mega-nav-ctrl" class="mega-nav-ctrl">
            <div class="mega-nav-ctrl-items">
              <img src="../../../assets/images/mega-nav/logo-hashicorp-a66fda95.svg" alt="HashiCorp Logo" />
              <strong>HashiCorp Suite</strong>
              <span class="mega-nav-icon-outline">
                <svg class="mega-nav-icon mega-nav-icon-angle-right" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-angle"></use></svg><span class="visuallyhidden">Open</span>
              </span>
            </div>
          </button>
          <div id="mega-nav-body-ct" class="mega-nav-body-ct" aria-labelledby="mega-nav-ctrl">
            <div class="mega-nav-body">
              <button type="button" id="mega-nav-close" class="mega-nav-close"><svg class="mega-nav-icon mega-nav-icon-close" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-close"></use></svg><span class="visuallyhidden">Close</span></button>
              <div class="mega-nav-body-header">
                <div class="mega-nav-body-header-item">
                  <h2 class="mega-nav-h1">Provision, Secure, Connect, and&nbsp;Run</h2>
                  <p class="mega-nav-h2">Any infrastructure for any&nbsp;application</p>
                </div>
                <div class="mega-nav-body-header-item">
                  <a href="https://www.hashicorp.com/" class="mega-nav-btn"><img src="../../../assets/images/mega-nav/logo-hashicorp-a66fda95.svg" alt="HashiCorp Logo" /> Learn the HashiCorp Enterprise&nbsp;Suite <svg class="mega-nav-icon mega-nav-icon-angle-right" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-angle"></use></svg></a>
                </div>
              </div>
              <div class="mega-nav-body-grid">
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Provision</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.vagrantup.com" class="mega-nav-grid-item mega-nav-grid-item-vagrant">
                        <div class="mega-nav-grid-item-img">
                          <img src="../../../assets/images/mega-nav/logo-vagrant-a7ab5898.svg" alt="Vagrant Logo" />
                        </div>
                        <b>Vagrant</b>
                        <ul>
                          <li><span class="mega-nav-tag">Build</span></li>
                          <li><span class="mega-nav-tag">Test</span></li>
                        </ul>
                      </a>
                    </li>
                    <li>
                      <a href="https://www.packer.io" class="mega-nav-grid-item mega-nav-grid-item-packer">
                        <div class="mega-nav-grid-item-img">
                          <img src="../../../assets/images/mega-nav/logo-packer-cb3b9b94.svg" alt="Packer Logo" />
                        </div>
                        <b>Packer</b>
                        <ul>
                          <li><span class="mega-nav-tag">Package</span></li>
                        </ul>
                      </a>
                    </li>
                    <li>
                      <a href="https://www.terraform.io" class="mega-nav-grid-item mega-nav-grid-item-terraform">
                        <div class="mega-nav-grid-item-img">
                          <img src="../../../assets/images/mega-nav/logo-terraform-ff69eaae.svg" alt="Terraform Logo" />
                        </div>
                        <b>Terraform</b>
                        <ul>
                          <li><span class="mega-nav-tag">Provision</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Secure</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.vaultproject.io" class="mega-nav-grid-item mega-nav-grid-item-vault">
                        <div class="mega-nav-grid-item-img">
                          <img src="../../../assets/images/mega-nav/logo-vault-0f83e3d2.svg" alt="Vault Logo" />
                        </div>
                        <b>Vault</b>
                        <ul>
                          <li><span class="mega-nav-tag">Secure</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Connect</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.consul.io" class="mega-nav-grid-item mega-nav-grid-item-consul">
                        <div class="mega-nav-grid-item-img">
                          <img src="../../../assets/images/mega-nav/logo-consul-c77f6844.svg" alt="Consul Logo" />
                        </div>
                        <b>Consul</b>
                        <ul>
                          <li><span class="mega-nav-tag">Connect</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Run</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.nomadproject.io" class="mega-nav-grid-item mega-nav-grid-item-nomad">
                        <div class="mega-nav-grid-item-img">
                          <img src="../../../assets/images/mega-nav/logo-nomad-c4c148be.svg" alt="Nomad Logo" />
                        </div>
                        <b>Nomad</b>
                        <ul>
                          <li><span class="mega-nav-tag">Run</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="mega-nav-body-footer">
                <p>Seven elements of the modern Application Lifecycle</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


    <div id="header" class="navigation navbar-static-top hidden-print">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <div class="navbar-header">
              <div class="navbar-brand">
                <a href="/">
                  <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 251 61" class="logo" height="50">
  <path class="text" fill="#000" fill-rule="nonzero" d="M81.78 19.54h-8.89v-5.31H96.7v5.31h-8.9v26.53h-6"></path>
  <path class="text" fill="#000" fill-rule="nonzero" d="M102.19 41.77c2.415-.012 4.814-.383 7.12-1.1l.91 4.4c-2.745.99-5.642 1.49-8.56 1.48-7.31 0-9.85-3.39-9.85-9V31.4c0-4.92 2.2-9.08 9.66-9.08s9.13 4.35 9.13 9.37v5h-13v1.2c.05 2.78 1.05 3.88 4.59 3.88zM97.65 32h7.41v-1.18c0-2.2-.67-3.73-3.54-3.73s-3.87 1.53-3.87 3.73V32zm28.54-4.33c-2.148.97-4.217 2.102-6.19 3.39v15h-5.83V22.79h4.92l.38 2.58c1.897-1.284 3.955-2.313 6.12-3.06l.6 5.36zm14.24 0c-2.14.97-4.204 2.103-6.17 3.39v15h-5.83V22.79h4.92l.38 2.58c1.897-1.284 3.955-2.313 6.12-3.06l.58 5.36zm19.51 18.4h-4.78l-.43-1.58c-2.062 1.342-4.47 2.058-6.93 2.06-4.25 0-6.07-2.92-6.07-6.93 0-4.73 2.06-6.55 6.79-6.55h5.59v-2.44c0-2.58-.72-3.49-4.45-3.49-2.17.024-4.33.266-6.45.72l-.72-4.45c2.606-.72 5.296-1.09 8-1.1 7.31 0 9.47 2.58 9.47 8.41l-.02 15.35zm-5.83-8.8h-4.3c-1.91 0-2.44.53-2.44 2.29s.53 2.34 2.34 2.34c1.544-.024 3.058-.436 4.4-1.2v-3.43zm23.75-19.79c-1.1-.237-2.224-.364-3.35-.38-2.29 0-2.63 1-2.63 2.77v2.92h5.93l-.33 4.64h-5.59v18.64h-5.83V27.43h-3.73v-4.64h3.73v-3.25c0-4.83 2.25-7.22 7.41-7.22 1.69-.006 3.372.22 5 .67l-.61 4.49zm11.38 29.07c-8 0-10.13-4.4-10.13-9.18v-5.88c0-4.78 2.15-9.18 10.13-9.18s10.13 4.4 10.13 9.18v5.88c.01 4.78-2.15 9.18-10.13 9.18zm0-19.27c-3.11 0-4.3 1.39-4.3 4v6.26c0 2.63 1.2 4 4.3 4 3.1 0 4.3-1.39 4.3-4V31.3c0-2.63-1.19-4.02-4.3-4.02zm25.14.39c-2.14.97-4.204 2.103-6.17 3.39v15h-5.83V22.79h4.92l.38 2.58c1.897-1.284 3.954-2.313 6.12-3.06l.58 5.36zm16.02 18.4V29.82c0-1.24-.53-1.86-1.86-1.86-2.137.254-4.2.934-6.07 2v16.11h-5.83V22.79h4.45l.57 2c2.906-1.47 6.088-2.315 9.34-2.48 1.843-.174 3.6.82 4.4 2.49 2.91-1.49 6.104-2.34 9.37-2.49 3.87 0 5.26 2.72 5.26 6.88v16.88h-5.83V29.82c0-1.24-.53-1.86-1.86-1.86-2.14.236-4.208.917-6.07 2v16.11h-5.87z"></path>
  <path class="rect-dark" fill="#4040B2" d="M36.4 39.13l16.4-9.46V10.72L36.4 20.2"></path>
  <path class="rect-light" fill="#5C4EE5" d="M18.2 10.72l16.4 9.48v18.93l-16.4-9.47"></path>
  <path class="rect-light" fill="#5C4EE5" d="M0 19.09l16.4 9.47V9.62L0 .15m18.2 50.53l16.4 9.47V41.21l-16.4-9.47"></path>
</svg>

                </a>
              </div>
              <button class="navbar-toggle" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="buttons hidden-xs">
              <nav class="navigation-links" role="navigation">
                <ul class="main-links nav navbar-nav navbar-right">
                  <li><a href="/intro/index.html">Intro</a></li>
                  <li><a href="https://learn.hashicorp.com/terraform/">Learn</a></li>
                  <li><a href="/docs/index.html">Docs</a></li>
                  <li><a href="/guides/index.html">Guides</a></li>
                  <li><a href="/docs/extend/index.html">Extend</a></li>
                  <li><a href="https://www.hashicorp.com/products/terraform/?utm_source=oss&utm_medium=header-nav&utm_campaign=terraform">Enterprise</a></li>
                  <li>
                    <a href="/downloads.html">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h28V0zM13.8 22.9L7 17.3l2-2.4 3.2 2.6V7h3.2v10.5l3.2-2.6 2 2.4L13.8 22.9z"></path>
</svg>
 Download
                    </a>
                  </li>
                  <li>
                    <a href="https://github.com/hashicorp/terraform">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h11.4c0 0 0-1.3 0-2.4C7.7 26.4 7 23.9 7 23.9 6.4 22.4 5.5 22 5.5 22c-1.2-0.8 0.1-0.8 0.1-0.8 1.3 0.1 2 1.4 2 1.4 1.2 2 3 1.4 3.8 1.1 0.1-0.8 0.5-1.4 0.9-1.8 -2.9-0.3-6-1.5-6-6.5 0-1.4 0.5-2.6 1.3-3.5C7.5 11.5 7 10.2 7.8 8.4c0 0 1.1-0.4 3.6 1.3 1-0.3 2.2-0.4 3.3-0.4 1.1 0 2.2 0.2 3.3 0.4 2.5-1.7 3.6-1.3 3.6-1.3 0.7 1.8 0.3 3.1 0.1 3.5 0.8 0.9 1.3 2.1 1.3 3.5 0 5-3.1 6.1-6 6.5 0.5 0.4 0.9 1.2 0.9 2.4 0 1.8 0 3.7 0 3.7H28V0z"></path>
</svg>
 GitHub
                    </a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar-overlay"></div>

<aside class="sidebar" role="navigation">
  <div class="sidebar-header">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 251 61" class="logo" height="42">
  <path class="text" fill="#000" fill-rule="nonzero" d="M81.78 19.54h-8.89v-5.31H96.7v5.31h-8.9v26.53h-6"></path>
  <path class="text" fill="#000" fill-rule="nonzero" d="M102.19 41.77c2.415-.012 4.814-.383 7.12-1.1l.91 4.4c-2.745.99-5.642 1.49-8.56 1.48-7.31 0-9.85-3.39-9.85-9V31.4c0-4.92 2.2-9.08 9.66-9.08s9.13 4.35 9.13 9.37v5h-13v1.2c.05 2.78 1.05 3.88 4.59 3.88zM97.65 32h7.41v-1.18c0-2.2-.67-3.73-3.54-3.73s-3.87 1.53-3.87 3.73V32zm28.54-4.33c-2.148.97-4.217 2.102-6.19 3.39v15h-5.83V22.79h4.92l.38 2.58c1.897-1.284 3.955-2.313 6.12-3.06l.6 5.36zm14.24 0c-2.14.97-4.204 2.103-6.17 3.39v15h-5.83V22.79h4.92l.38 2.58c1.897-1.284 3.955-2.313 6.12-3.06l.58 5.36zm19.51 18.4h-4.78l-.43-1.58c-2.062 1.342-4.47 2.058-6.93 2.06-4.25 0-6.07-2.92-6.07-6.93 0-4.73 2.06-6.55 6.79-6.55h5.59v-2.44c0-2.58-.72-3.49-4.45-3.49-2.17.024-4.33.266-6.45.72l-.72-4.45c2.606-.72 5.296-1.09 8-1.1 7.31 0 9.47 2.58 9.47 8.41l-.02 15.35zm-5.83-8.8h-4.3c-1.91 0-2.44.53-2.44 2.29s.53 2.34 2.34 2.34c1.544-.024 3.058-.436 4.4-1.2v-3.43zm23.75-19.79c-1.1-.237-2.224-.364-3.35-.38-2.29 0-2.63 1-2.63 2.77v2.92h5.93l-.33 4.64h-5.59v18.64h-5.83V27.43h-3.73v-4.64h3.73v-3.25c0-4.83 2.25-7.22 7.41-7.22 1.69-.006 3.372.22 5 .67l-.61 4.49zm11.38 29.07c-8 0-10.13-4.4-10.13-9.18v-5.88c0-4.78 2.15-9.18 10.13-9.18s10.13 4.4 10.13 9.18v5.88c.01 4.78-2.15 9.18-10.13 9.18zm0-19.27c-3.11 0-4.3 1.39-4.3 4v6.26c0 2.63 1.2 4 4.3 4 3.1 0 4.3-1.39 4.3-4V31.3c0-2.63-1.19-4.02-4.3-4.02zm25.14.39c-2.14.97-4.204 2.103-6.17 3.39v15h-5.83V22.79h4.92l.38 2.58c1.897-1.284 3.954-2.313 6.12-3.06l.58 5.36zm16.02 18.4V29.82c0-1.24-.53-1.86-1.86-1.86-2.137.254-4.2.934-6.07 2v16.11h-5.83V22.79h4.45l.57 2c2.906-1.47 6.088-2.315 9.34-2.48 1.843-.174 3.6.82 4.4 2.49 2.91-1.49 6.104-2.34 9.37-2.49 3.87 0 5.26 2.72 5.26 6.88v16.88h-5.83V29.82c0-1.24-.53-1.86-1.86-1.86-2.14.236-4.208.917-6.07 2v16.11h-5.87z"></path>
  <path class="rect-dark" fill="#4040B2" d="M36.4 39.13l16.4-9.46V10.72L36.4 20.2"></path>
  <path class="rect-light" fill="#5C4EE5" d="M18.2 10.72l16.4 9.48v18.93l-16.4-9.47"></path>
  <path class="rect-light" fill="#5C4EE5" d="M0 19.09l16.4 9.47V9.62L0 .15m18.2 50.53l16.4 9.47V41.21l-16.4-9.47"></path>
</svg>

  </div>

  <ul class="nav sidebar-nav">
    <li><a href="/intro/index.html">Intro</a></li>
    <li><a href="https://learn.hashicorp.com/terraform/">Learn</a></li>
    <li><a href="/docs/index.html">Docs</a></li>
    <li><a href="/guides/index.html">Guides</a></li>
    <li><a href="/docs/extend/index.html">Extend</a></li>
    <li><a href="https://www.hashicorp.com/products/terraform/?utm_source=oss&utm_medium=header-nav&utm_campaign=terraform">Enterprise</a></li>
  </ul>

  <div class="divider"></div>

  <ul class="external nav sidebar-nav">
    <li>
      <a href="/downloads.html">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h28V0zM13.8 22.9L7 17.3l2-2.4 3.2 2.6V7h3.2v10.5l3.2-2.6 2 2.4L13.8 22.9z"></path>
</svg>
 Download
      </a>
    </li>
    <li>
      <a href="https://github.com/hashicorp/terraform">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h11.4c0 0 0-1.3 0-2.4C7.7 26.4 7 23.9 7 23.9 6.4 22.4 5.5 22 5.5 22c-1.2-0.8 0.1-0.8 0.1-0.8 1.3 0.1 2 1.4 2 1.4 1.2 2 3 1.4 3.8 1.1 0.1-0.8 0.5-1.4 0.9-1.8 -2.9-0.3-6-1.5-6-6.5 0-1.4 0.5-2.6 1.3-3.5C7.5 11.5 7 10.2 7.8 8.4c0 0 1.1-0.4 3.6 1.3 1-0.3 2.2-0.4 3.3-0.4 1.1 0 2.2 0.2 3.3 0.4 2.5-1.7 3.6-1.3 3.6-1.3 0.7 1.8 0.3 3.1 0.1 3.5 0.8 0.9 1.3 2.1 1.3 3.5 0 5-3.1 6.1-6 6.5 0.5 0.4 0.9 1.2 0.9 2.4 0 1.8 0 3.7 0 3.7H28V0z"></path>
</svg>
 GitHub
      </a>
    </li>
  </ul>
</aside>


    <div class="container">
  <div class="row">
    <div id="docs-sidebar" class="col-sm-4 col-md-3 col-xs-12 hidden-print" role="complementary">
          <h4><a href="/docs/enterprise/index.html">Terraform Enterprise</a></h4>

    <ul class="nav docs-sidenav">
      <li>
        <a href="/docs/enterprise/getting-started/index.html">Getting Started</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/getting-started/access.html">Accessing TFE</a>
          </li>
          <li>
            <a href="/docs/enterprise/getting-started/vcs.html">Configuring VCS Access</a>
          </li>
          <li>
            <a href="/docs/enterprise/getting-started/workspaces.html">Creating Workspaces</a>
          </li>
          <li>
            <a href="/docs/enterprise/getting-started/runs.html">Running Terraform</a>
          </li>
          <li>
            <a href="/docs/enterprise/getting-started/policies.html">Creating Policies</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/docs/enterprise/migrate/index.html">Migrating from Open Source</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/migrate/workspaces.html">Migrating Multiple Workspaces</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/docs/enterprise/upgrade/index.html">Upgrading</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/upgrade/batch.html">Batch migration</a>
          </li>
          <li>
            <a href="/docs/enterprise/upgrade/differences.html">Current vs. Legacy</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/docs/enterprise/vcs/index.html">VCS Integration</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/vcs/github.html">Github</a>
          </li>
          <li>
            <a href="/docs/enterprise/vcs/github-enterprise.html">Github Enterprise</a>
          </li>
          <li>
            <a href="/docs/enterprise/vcs/gitlab-com.html">GitLab.com</a>
          </li>
          <li>
            <a href="/docs/enterprise/vcs/gitlab-eece.html">GitLab EE and CE</a>
          </li>
          <li>
            <a href="/docs/enterprise/vcs/bitbucket-cloud.html">Bitbucket Cloud</a>
          </li>
          <li>
            <a href="/docs/enterprise/vcs/bitbucket-server.html">Bitbucket Server</a>
          </li>
          <li>
            <a href="/docs/enterprise/vcs/troubleshooting.html">Troubleshooting</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/docs/enterprise/workspaces/index.html">Workspaces</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/workspaces/naming.html">Naming</a>
          </li>
          <li>
            <a href="/docs/enterprise/workspaces/creating.html">Creating Workspaces</a>
          </li>
          <li>
            <a href="/docs/enterprise/workspaces/access.html">Managing Access</a>
          </li>
          <li>
            <a href="/docs/enterprise/workspaces/repo-structure.html">Repo Structure</a>
          </li>
          <li>
            <a href="/docs/enterprise/workspaces/settings.html">Settings</a>
          </li>
          <li>
            <a href="/docs/enterprise/workspaces/notifications.html">Notifications</a>
          </li>
          <li>
            <a href="/docs/enterprise/workspaces/variables.html">Variables</a>
          </li>
          <li>
            <a href="/docs/enterprise/workspaces/ssh-keys.html">SSH Keys for Modules</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/docs/enterprise/run/index.html">Terraform Runs</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/run/states.html">Run States and Stages</a>
          </li>
          <li>
            <a href="/docs/enterprise/run/ui.html">UI/VCS-driven Runs</a>
          </li>
          <li>
            <a href="/docs/enterprise/run/api.html">API-driven Runs</a>
          </li>
          <li>
            <a href="/docs/enterprise/run/cli.html">CLI-driven Runs</a>
          </li>
          <li>
            <a href="/docs/enterprise/run/install-software.html">Installing Software</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/docs/enterprise/registry/index.html">Private Module Registry</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/registry/using.html">Using Private Modules</a>
          </li>
          <li>
            <a href="/docs/enterprise/registry/publish.html">Publishing Private Modules</a>
          </li>
          <li>
            <a href="/docs/enterprise/registry/design.html">Configuration Designer</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/docs/enterprise/users-teams-organizations/index.html">Users, Teams, Organizations</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/users-teams-organizations/users.html">Users</a>
          </li>
          <li>
            <a href="/docs/enterprise/users-teams-organizations/teams.html">Teams</a>
          </li>
          <li>
            <a href="/docs/enterprise/users-teams-organizations/organizations.html">Organizations</a>
          </li>
          <li>
            <a href="/docs/enterprise/users-teams-organizations/permissions.html">Permissions</a>
          </li>
          <li>
          <a href="/docs/enterprise/users-teams-organizations/2fa.html">Two-factor Authentication</a>
        </li>
          <li>
            <a href="/docs/enterprise/users-teams-organizations/service-accounts.html">Service Accounts</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/docs/enterprise/sentinel/index.html">Sentinel</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/sentinel/manage-policies.html">Manage Policies</a>
          </li>
          <li>
            <a href="/docs/enterprise/sentinel/integrate-vcs.html">Manage Policies with VCS</a>
          </li>
          <li>
            <a href="/docs/enterprise/sentinel/enforce.html">Enforce and Override Policies</a>
          </li>
          <li>
            <a href="/docs/enterprise/sentinel/import/index.html">Defining Policies</a>
            <ul class="nav">
              <li>
                <a href="/docs/enterprise/sentinel/import/tfplan.html">import: tfplan</a>
                <ul class="nav">
                  <li>
                    <a href="/docs/enterprise/sentinel/import/mock-tfplan.html">Mocking tfplan Data</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="/docs/enterprise/sentinel/import/tfconfig.html">import: tfconfig</a>
                <ul class="nav">
                  <li>
                    <a href="/docs/enterprise/sentinel/import/mock-tfconfig.html">Mocking tfconfig Data</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="/docs/enterprise/sentinel/import/tfstate.html">import: tfstate</a>
                <ul class="nav">
                  <li>
                    <a href="/docs/enterprise/sentinel/import/mock-tfstate.html">Mocking tfstate Data</a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/enterprise/sentinel/examples.html">Example Policies</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/docs/enterprise/api/index.html">API</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/api/account.html">Account</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/applies.html">Applies</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/configuration-versions.html">Configuration Versions</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/notification-configurations.html">Notification Configurations</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/oauth-clients.html">OAuth Clients</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/oauth-tokens.html">OAuth Tokens</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/organizations.html">Organizations</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/organization-tokens.html">Organization Tokens</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/plans.html">Plans</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/policies.html">Policies</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/policy-checks.html">Policy Checks</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/policy-sets.html">Policy Sets</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/modules.html">Registry Modules</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/run.html">Runs</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/ssh-keys.html">SSH Keys</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/state-versions.html">State Versions</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/team-access.html">Team Access</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/team-members.html">Team Membership</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/team-tokens.html">Team Tokens</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/teams.html">Teams</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/user-tokens.html">User Tokens</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/users.html">Users</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/variables.html">Variables</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/workspaces.html">Workspaces</a>
          </li>
          <li>
            <a href="/docs/enterprise/api/admin/index.html">Admin</a>
            <ul class="nav">
              <li>
                <a href="/docs/enterprise/api/admin/organizations.html">Organizations</a>
              </li>
              <li>
                <a href="/docs/enterprise/api/admin/runs.html">Runs</a>
              </li>
              <li>
                <a href="/docs/enterprise/api/admin/settings.html">Settings</a>
              </li>
              <li>
                <a href="/docs/enterprise/api/admin/terraform-versions.html">Terraform Versions</a>
              </li>
              <li>
                <a href="/docs/enterprise/api/admin/users.html">Users</a>
              </li>
              <li>
                <a href="/docs/enterprise/api/admin/workspaces.html">Workspaces</a>
              </li>
            </ul>
          </li>
        </ul>
      </li>

      <hr>

      <li class="active">
        <a href="/docs/enterprise/private/index.html">Private Terraform Enterprise</a>
        <ul class="nav">
          <li>
            <a href="/docs/enterprise/private/reference-architecture-installer.html">Reference Architecture (Installer)</a>
            <ul class="nav">
              <li>
                <a href="/docs/enterprise/private/aws-setup-guide.html">AWS Reference Architecture</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/azure-setup-guide.html">Azure Reference Architecture</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/gcp-setup-guide.html">GCP Reference Architecture</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/vmware-setup-guide.html">VMware Reference Architecture</a>
              </li>
            </ul>
          <li class="active">
            <a href="/docs/enterprise/private/install-installer.html">Installation (Installer)</a>
            <ul class="nav">
              <li>
                <a href="/docs/enterprise/private/preflight-installer.html">Installer Preflight</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/install-installer.html">Installation</a>
              </li>
              <li class="active">
                <a href="/docs/enterprise/private/migrate.html">Migrate from AMI</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/rhel-install-guide.html">RedHat Enterprise Linux Install Guide</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/centos-install-guide.html">CentOS Linux Install Guide</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/minio-setup-guide.html">Minio Setup Guide</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/automating-the-installer.html">Automated Installation</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/automating-initial-user.html">Initial Admin Automation </a>
              </li>
              <li>
                <a href="/docs/enterprise/private/upgrades.html">Upgrades</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/vault.html">External Vault</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/automated-recovery.html">Automated Recovery</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/capacity.html">Capacity &amp; Performance</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/enterprise/private/install-ami.html">Installation (AMI)</a>
          </li>
          <li>
            <a href="/docs/enterprise/private/config.html">Configuration</a>
          </li>
          <li>
            <a href="/docs/enterprise/private/admin/index.html">Administration</a>
            <ul class="nav">
              <li>
                <a href="/docs/enterprise/private/admin/general.html">General Settings</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/admin/integration.html">Integration Settings</a>
              </li>
              <li>
                <a href="/docs/enterprise/private/admin/resources.html">Managing Accounts &amp; Resources</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/enterprise/saml/index.html">SAML SSO</a>
            <ul class="nav">
              <li>
                <a href="/docs/enterprise/saml/configuration.html">Configuration</a>
              </li>
              <li>
                <a href="/docs/enterprise/saml/team-membership.html">Team Membership</a>
              </li>
              <li>
                <a href="/docs/enterprise/saml/attributes.html">Attributes</a>
              </li>
              <li>
                <a href="/docs/enterprise/saml/login.html">Login</a>
              </li>
              <li>
                <a href="/docs/enterprise/saml/identity-provider-configuration.html">Identity Provider Configuration</a>
                <ul class="nav">
                  <li>
                    <a href="/docs/enterprise/saml/identity-provider-configuration-adfs.html">ADFS</a>
                  </li>
                  <li>
                    <a href="/docs/enterprise/saml/identity-provider-configuration-aad.html">Azure Active Directory</a>
                  </li>
                  <li>
                    <a href="/docs/enterprise/saml/identity-provider-configuration-okta.html">Okta</a>
                  </li>
                  <li>
                    <a href="/docs/enterprise/saml/identity-provider-configuration-onelogin.html">OneLogin</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="/docs/enterprise/saml/troubleshooting.html">Troubleshooting</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/docs/enterprise/private/reliability-availability.html">Reliability &amp; Availability</a>
          </li>
          <li>
            <a href="/docs/enterprise/private/data-security.html">Data Security</a>
          </li>
          <li>
            <a href="/docs/enterprise/private/logging.html">Logging</a>
          </li>
          <li>
            <a href="/docs/enterprise/private/monitoring.html">Monitoring</a>
          </li>
          <li>
            <a href="/docs/enterprise/private/diagnostics.html">Diagnostics</a>
          </li>
          <li>
            <a href="/docs/enterprise/private/faq.html">FAQs</a>
          </li>
        </ul>
      </li>

      <hr>

      <li>
        <a class="back" href="/docs/enterprise-legacy/index.html">Terraform Enterprise (legacy)</a>
      </li>
    </ul>

        <h4>Other Docs</h4>

    <ul class="nav docs-sidenav">
      <li>
        <a class="back" href="/docs/cli-index.html">Terraform CLI</a>
      </li>
      <li>
        <a class="back" href="/docs/providers/index.html">Provider References</a>
      </li>
      <li>
        <a class="back" href="/docs/glossary.html">Terraform Glossary</a>
      </li>
      <li>
        <a class="back" href="/intro/index.html">Introduction to Terraform</a>
      </li>
      <li>
        <a class="back" href="/guides/index.html">Guides and Whitepapers</a>
      </li>
      <li>
        <a class="back" href="/docs/registry/index.html">Terraform Registry</a>
      </li>
      <li>
        <a class="back" href="/docs/github-actions/index.html">Terraform GitHub Actions</a>
      </li>
      <li>
        <a class="back" href="/docs/extend/index.html">Extending Terraform</a>
      </li>
    </ul>



    </div>

    <div id="inner" class="col-sm-8 col-md-9 col-xs-12" role="main">
      
  <h1 id="private-terraform-enterprise-installer-migration">
  <a name="private-terraform-enterprise-installer-migration" class="anchor" href="#private-terraform-enterprise-installer-migration">&raquo;</a>
  Private Terraform Enterprise Installer Migration
</h1>
<p>This document outlines the procedure for migrating from the AMI-based Private Terraform Enterprise (PTFE)
to the Installer-based PTFE.</p>
<h2 id="terraform-state">
  <a name="terraform-state" class="anchor" href="#terraform-state">&raquo;</a>
  Terraform State
</h2>
<p>To run this procedure, you&#39;ll need the Terraform state file used to create the AMI-based installation. Additionally, we strongly suggest you back up this state file before proceeding with this process, in the event that you need to revert back to the AMI.</p>
<h2 id="backup">
  <a name="backup" class="anchor" href="#backup">&raquo;</a>
  Backup
</h2>
<p>Before beginning, it&#39;s best to create an additional backup of your RDS database. This will allow you to roll back the data and continue to use the AMI if necessary.</p>
<p>To create an RDS backup, go to the <a href="https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:">Amazon RDS Instances</a>. You may need to change the region that you are viewing in order to see your PTFE instance. Once you find it, click on the instance name. On the next page, select <strong>Instance Actions</strong> and then <strong>Take snapshot</strong>. On the <strong>Take DB Snapshot</strong> page, enter a name for the snapshot such as <code>Pre-Installer Migration</code>, and then click <strong>Take Snapshot</strong>.</p>
<p>The snapshot will take a little while to create. After it has finished, you can continue with the rest of the migration steps.</p>
<h3 id="reverting-back-to-the-ami">
  <a name="reverting-back-to-the-ami" class="anchor" href="#reverting-back-to-the-ami">&raquo;</a>
  Reverting back to the AMI
</h3>
<p>To revert to the AMI after running the migration script:</p>

<ul>
<li>If you&#39;ve already manipulated the state file to move the resources, you&#39;ll need to restore the original state file.
</li>
<li>With your original Terraform state file in place, return to the <a href="https://console.aws.amazon.com/rds/home?region=us-east-1#db-snapshots:">Amazon RDS Snapshots</a> and find the snapshot you created before migrating. Click on the snapshot and note its <strong>ARN</strong> value. Open your <strong>.tfvars</strong> file and add <code>db_snapshot = &quot;arn-value-of-snapshot&quot;</code>.
</li>
<li>Run <code>terraform apply</code> to make sure everything is set up. This will result in a new RDS instance being built against the snapshot.
</li>
<li>If the EC2 instance is still running from the migration process, run <code>shutdown</code> on it to get a new instance created.
</li>
<li>Return to the original hostname used for the cluster.
</li>
</ul>
<h2 id="simple-upgrade-recommended-">
  <a name="simple-upgrade-recommended-" class="anchor" href="#simple-upgrade-recommended-">&raquo;</a>
  Simple Upgrade (Recommended)
</h2>
<p>For users who did not significantly change the reference Terraform modules used to deploy
the AMI, we recommend following the migration path outlined on the
<a href="/docs/enterprise/private/simplified-migration.html">Simplified Migration Page</a>.</p>
<p>For users who modified the Terraform modules, we recommend following the steps below. If you prefer,
you can follow the <a href="/docs/enterprise/private/simplified-migration.html">simplified steps</a> as well, but you&#39;ll likely need to
modify some Terraform modules again to match the modifications you made in the past.</p>
<h2 id="preflight">
  <a name="preflight" class="anchor" href="#preflight">&raquo;</a>
  Preflight
</h2>
<p>Before you begin, consult <a href="/docs/enterprise/private/preflight-installer.html">Preflight</a> for pre-requisites for the installer setup. You&#39;ll need to prepare data files and a Linux instance.</p>
<h2 id="proxy-usage">
  <a name="proxy-usage" class="anchor" href="#proxy-usage">&raquo;</a>
  Proxy Usage
</h2>
<p>If your installation requires using a proxy server, you will be asked for the proxy server information when you first
run the installer via <code>ssh</code>. This proxy server will be used for all outbound HTTP and HTTPS connections.</p>
<p>Optionally, if you&#39;re running the installer script in an automated manner, you can pass a <code>http-proxy</code> flag to set
the address of the proxy. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>./install.sh http-proxy=http://internal.mycompany.com:8080
</code></pre></div><h3 id="proxy-exclusions-no_proxy-">
  <a name="proxy-exclusions-no_proxy-" class="anchor" href="#proxy-exclusions-no_proxy-">&raquo;</a>
  Proxy Exclusions (NO_PROXY)
</h3>
<p>If certain hostnames should not use the proxy and the instance should connect directly to them (for instance for S3), then you can pass an additional option to provide a list of domains:</p>
<div class="highlight"><pre class="highlight plaintext"><code>./install.sh additional-no-proxy=s3.amazonaws.com,internal-vcs.mycompany.com,example.com
</code></pre></div><p>Passing this option to the installation script is particularly useful if the hostnames that should not use the proxy include services that the instance needs to be able to reach during installation, such as S3. Alternately, if the only hosts you need to add are those that are not used during installation, such as a private VCS instance, you can provide these hosts after initial installation is complete, in the installer settings (available on port 8800 under <code>/console/settings</code>).</p>
<h3 id="reconfiguring-the-proxy">
  <a name="reconfiguring-the-proxy" class="anchor" href="#reconfiguring-the-proxy">&raquo;</a>
  Reconfiguring the Proxy
</h3>
<p>To change the proxy settings after installation, use the Console settings page, accessed from the dashboard on port 8800 under <code>/console/settings</code>.</p>
<p><img alt="PTFE Console Settings" src="assets/ptfe-console-settings-d3109fa7.png" /></p>
<p>On the Console Settings page, there is a section for HTTP Proxy:</p>
<p><img alt="PTFE HTTP Proxy Settings" src="assets/ptfe-http-proxy-8b33ac46.png" /></p>
<h2 id="trusting-ssl-tls-certificates">
  <a name="trusting-ssl-tls-certificates" class="anchor" href="#trusting-ssl-tls-certificates">&raquo;</a>
  Trusting SSL/TLS Certificates
</h2>
<p>There are two primary areas for SSL configuration in the installer.</p>
<h3 id="tls-key-amp-cert">
  <a name="tls-key-amp-cert" class="anchor" href="#tls-key-amp-cert">&raquo;</a>
  TLS Key &amp; Cert
</h3>
<p>The TLS Key &amp; Cert field (found in the console settings after initial installation) should contain PTFE&#39;s own key and certificate, or key and certificate chain. A chain would be used in this field if the CA indicates an intermediate certificate is required as well.</p>
<h3 id="certificate-authority-ca-bundle">
  <a name="certificate-authority-ca-bundle" class="anchor" href="#certificate-authority-ca-bundle">&raquo;</a>
  Certificate Authority (CA) Bundle
</h3>
<p>PTFE needs to be able to access all services that it integrates with, such as VCS providers.
Because it typically accesses them via SSL/TLS, it is critical that the certificates used by any service
that PTFE integrates with are trusted by PTFE.</p>
<p>This section is used to allow PTFE to connect to services that use SSL/TLS certificates issued by private CAs.
It allows multiple certificates to be specified as trusted, and should contain all certificates that PTFE
should trust when presented with them from itself or another application.</p>
<p>A collection of certificates for trusted issuers is known as a <code>Certificate Authority (CA) Bundle</code>.
All certificates in the certificate signing chain, meaning the root certificate and any intermediate certificates,
must be included here. These multiple certificates are listed one after another in text format.</p>
<div class="alert alert-warning" role="alert">
<p><strong>Note:</strong> If PTFE is configured with a SSL key and certificate issued against a private CA,
   the certificate chain for that CA must be included here as well. This allows the instance
   to query itself.</p>
</div>
<p>Certificates must be formatted using PEM encoding, that is, as text. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>-----BEGIN CERTIFICATE-----
MIIFtTCCA52gAwIBAgIIYY3HhjsBggUwDQYJKoZIhvcNAQEFBQAwRDEWMBQGA1UE
AwwNQUNFRElDT00gUm9vdDEMMAoGA1UECwwDUEtJMQ8wDQYDVQQKDAZFRElDT00x
CzAJBgNVBAYTAkVTMB4XDTA4MDQxODE2MjQyMloXDTI4MDQxMzE2MjQyMlowRDEW
MBQGA1UEAwwNQUNFRElDT00gUm9vdDEMMAoGA1UECwwDUEtJMQ8wDQYDVQQKDAZF
....
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIB5zCCAY6gAwIBAgIUNJADaMM+URJrPMdoIeeAs9/CEt4wCgYIKoZIzj0EAwIw
UjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNp
c2NvMR4wHAYDVQQDExVoYXNoaWNvcnAuZW5naW5lZXJpbmcwHhcNMTgwMjI4MDYx
....
-----END CERTIFICATE-----
</code></pre></div><p>The UI to upload these certificates looks like:</p>
<p><img alt="ptfe-ca-ui" src="assets/ptfe-ca-bundle-f663451c.png" /></p>
<h2 id="operational-mode">
  <a name="operational-mode" class="anchor" href="#operational-mode">&raquo;</a>
  Operational Mode
</h2>
<p>As you are migrating from the AMI, you&#39;ll be using <strong>Production - External Services</strong> to
access the data previously managed by the AMI-based installation. This means using RDS for
PostgreSQL and S3 to store the objects.</p>
<h2 id="begin-migration">
  <a name="begin-migration" class="anchor" href="#begin-migration">&raquo;</a>
  Begin Migration
</h2>
<p>Now that the instance has been booted into the correct Linux environment, you&#39;re ready to begin
the migration process.</p>
<div class="alert alert-warning" role="alert">
<p><strong>Note:</strong> The migration process will render the AMI-based installation inoperable. Be sure to back up
   RDS before beginning.</p>
</div>
<p>Schedule downtime for the installation and do not continue until that downtime period has
arrived.</p>
<h3 id="prepare-for-migration">
  <a name="prepare-for-migration" class="anchor" href="#prepare-for-migration">&raquo;</a>
  Prepare for migration
</h3>
<p>SSH to the instance currently running in your PTFE AutoScaling group. Then download
the migrator tool onto it to run the migration procedure:</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>curl <span class="nt">-O</span> https://s3.amazonaws.com/hashicorp-ptfe-data/migrator
<span class="nv">$ </span>chmod a+x migrator
</code></pre></div><h3 id="migrate-data-out-of-the-ami-instance">
  <a name="migrate-data-out-of-the-ami-instance" class="anchor" href="#migrate-data-out-of-the-ami-instance">&raquo;</a>
  Migrate data out of the AMI instance
</h3>
<div class="alert alert-warning" role="alert">
<p><strong>Note:</strong> The AMI instance will not function after this step. Certain services are stopped and
   should not be restarted after the migration. The migration moves data stored in Consul by
   the AMI (Vault data) into PostgreSQL to be used by the installer. If the AMI adds new
   data to Consul after the migration, the installer-based instance won&#39;t have access to it,
   destabilizing the system.</p>
</div>
<p>Next, create a password that will be used to protect the migration data
as it is passed to the installer. The password is only used for this migration process
and is not used after the migration is complete.</p>
<p>For this example, we&#39;ll use the password <code>ptfemigrate</code>, but you must change it to
a password of your own choosing.</p>
<p>This process shuts down certain services on the AMI instance to verify consistency
before moving data into the RDS instance to be used by the installer.</p>
<p>SSH into the AMI instance, then run these commands:</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span><span class="nb">sudo</span> ./migrator <span class="nt">-password</span> ptfemigrate
</code></pre></div><p>The command will ask you to confirm that you wish to continue. When are ready, run:</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span><span class="nb">sudo</span> ./migrator <span class="nt">-password</span> ptfemigrate <span class="nt">-confirm</span>
</code></pre></div><p>An example session of running the migrator looks like:</p>
<div class="highlight"><pre class="highlight shell"><code>This program will prepare your database <span class="k">for </span>migration as well as
output a block of text that you must provide when requested <span class="k">while
</span>later running this program on the linux instance being used
to run the installer.

This program will now shutdown some primary services before
continuing to be sure that the database is consistent
Shutting down services...
2018/05/25 17:37:04 Generated new root token to transmit
2018/05/25 17:37:04 connecting to postgresql at postgres://atlas:xxyyzz@tfe-aabbcc.ddeeff.us-west-2.rds.amazonaws.com:5432/atlas_production?&amp;options<span class="o">=</span><span class="nt">-c</span>%20search%5Fpath%3Dvault
2018/05/25 17:37:04 setup rails schema!
2018/05/25 17:37:04 writing core/audit
2018/05/25 17:37:04 writing core/auth
2018/05/25 17:37:04 writing core/cluster/local/info
2018/05/25 17:37:04 writing core/keyring
2018/05/25 17:37:04 writing core/leader/615b50e4-206d-9170-7971-f2b6b8a508fd
2018/05/25 17:37:04 writing core/local-audit
2018/05/25 17:37:04 writing core/local-auth
2018/05/25 17:37:04 writing core/local-mounts
2018/05/25 17:37:04 writing core/lock
2018/05/25 17:37:04 writing core/master
2018/05/25 17:37:04 writing core/mounts
2018/05/25 17:37:04 writing core/seal-config
2018/05/25 17:37:04 writing core/wrapping/jwtkey
2018/05/25 17:37:04 writing logical/91a7ef51-f1c5-b0a2-8755-3a4d86f1a082/ptfe-backup
2018/05/25 17:37:04 writing logical/91a7ef51-f1c5-b0a2-8755-3a4d86f1a082/setup-data
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/archivist_encoder
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/archivist_kdf
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/atlas_events_resource_diff
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/atlas_o_auth_clients_secret
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/atlas_o_auth_clients_webhook_secret
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/atlas_o_auth_tokens_info
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/atlas_o_auth_tokens_value
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/atlas_runs_metadata
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/atlas_runs_var_snapshot
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/atlas_setting_storage_postgres_value
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/atlas_vcs_hosts_webhook_secret
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/archive/atlas_vcs_repos_webhook_secret
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/archivist_encoder
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/archivist_kdf
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/atlas_events_resource_diff
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/atlas_o_auth_clients_secret
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/atlas_o_auth_clients_webhook_secret
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/atlas_o_auth_tokens_info
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/atlas_o_auth_tokens_value
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/atlas_runs_metadata
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/atlas_runs_var_snapshot
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/atlas_setting_storage_postgres_value
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/atlas_vcs_hosts_webhook_secret
2018/05/25 17:37:04 writing logical/e0eb6eb8-56e2-d564-8fc4-78ee882229e8/policy/atlas_vcs_repos_webhook_secret
2018/05/25 17:37:04 writing sys/expire/id/auth/token/create-orphan/5c40cdecc64ba276ca810a7d43cf69a4b486ad4d
2018/05/25 17:37:04 writing sys/expire/id/auth/token/create/aaf09a178b4658fd926f9193caef9e1817aae7c4
2018/05/25 17:37:04 writing sys/policy/archivist
2018/05/25 17:37:04 writing sys/policy/atlas
2018/05/25 17:37:04 writing sys/policy/default
2018/05/25 17:37:04 writing sys/policy/response-wrapping
2018/05/25 17:37:04 writing sys/token/accessor/105c7e4b4898cd905a915b48c7e8d3a20b7e8d25
2018/05/25 17:37:04 writing sys/token/accessor/9ff1ff31131be14d563ce1f0fb4781610175189f
2018/05/25 17:37:04 writing sys/token/accessor/b336f38abdbe381c8989c90f980c8267a3af999e
2018/05/25 17:37:04 writing sys/token/accessor/c0142d331857496927a3799ea9df277e69d0a982
2018/05/25 17:37:04 writing sys/token/id/5c40cdecc64ba276ca810a7d43cf69a4b486ad4d
2018/05/25 17:37:04 writing sys/token/id/5ed7ddc1674fbb42fe3ddcd278802a116b7cd4ab
2018/05/25 17:37:04 writing sys/token/id/aaf09a178b4658fd926f9193caef9e1817aae7c4
2018/05/25 17:37:04 writing sys/token/id/c356180d070a7aafa29f25416d5b8d2bba3dffa8
2018/05/25 17:37:04 writing sys/token/salt
2018/05/25 17:37:04 all vault data copied
copy and paste this data onto the instance PTFE will be installed on

<span class="nt">-----BEGIN</span> PTFE MIGRATION DATA-----
sl+VOHlCIKTq+aX7h/ZROP+bQkuJJlw/Is8WeFB/lfETBxXPmRwA6Ll9gYxyxpmq
hYUnw5Sj6IkHYGpwyw8tHdWyDTPHbtRZJtywGx8DAV6qi6gHbjjm93h4Rx5CIOZL
N3KBsHJR2tbp+xa1AtHxzzG+dzE1GzZwIbka/vOp2vQd47sroYSppMuH5GwcwM8G
sg64byIj00oj5UhF289hEoVlAL9jz51thzy8hXKC5UQtGnesva5c2hYMKu/Hkf68
7Irg7kWuruc+6MM9F2WIZ/gGGtMqEZQM2NL7WvBlcbbFZHDNGsWojiWhK+IJPK0C
vj217NebILBphOkoXiXsg0PnUNhovLl9Gp/4kuHUT01pZbTzdwd/Va0uLZLY4CFc
s8qx91pxLCVThCDEFJ4mfyFk7QObTl76ObxnqrGMSJ++Co/Wt264cUqDUoJ7rCdN
pQFtOcPk+0RLw4qBFPEL2iKOe4r878PajKaRThE4yt62noF/pfabV0yckVz2lfFY
vnlL85GxgpBdyMp4EGrJyxPqCMSCiBNLzMT6MZWynDlcRwkSf8xZyw36wMoF48Nz
nITmImg+IzyV+eb3gjRqAC6zl2Dd/QZiKti1fgwKt1YFSMIHOuHWpTsxh1b/fAtQ
Gchx01Jkp2kd73jxEEJ8r9yEDZzNf5Hh4U8IiLxFNCP/2UjEtPI5nNSnxm3/fj3v
<span class="nv">EhdSjIQGthiXHuU4gAOC4c0</span><span class="o">=</span>
<span class="nt">-----END</span> PTFE MIGRATION DATA-----
</code></pre></div><p>When the migrator command completes, the output will include some debugging information
to provide to support if there is an issue as well as a specially-formatting block of text
that looks like:</p>
<div class="highlight"><pre class="highlight plaintext"><code>-----BEGIN PTFE MIGRATION DATA-----
rbBuoUY1CZxFBH8sLHYpZzc7ndBD7on3aaro4Br9kV9W2t8PqOMYhS9Ts/nHr2ev
cpN3EQEuK+Bur/TBYEEHjXiiv71aGjO6c2z68yhvfafDbTfvW8N0rXDQM26F2rTa
1NGZNB1FUFPWFvPqbLW25xw5h+wn1FuOlEkqVsaBSdpYWGH/7NPtRDX2dN2ZhPYN
vs5T0wZ3ToPM7e7yfwI/0uMg+2lAK0h4L/ioYgLHBSN/bGr/Plfj6+CR7zza8XC3
kSv6kzGFr7fCT4BWzSJc38sOMviBY/TdyDPRlmmM7Flg9JLYIvLVxosRfIneQn60
K5Jcf1wJEsH/ZAQpEkbp6PzQKUmAlvEHf/fSAPxf3W3ulAubrCe2QmwsPIJkIGx/
uwfKgTCFr/svIkAtccTmeQ8pxAmNEA4CW/jEGlFkkZiu74+ia8KdF5lrtJBLA9Lj
J8sue9KYAB64fwQ+fISLfrMeahjgFip3gPXofDevM2gbIFvde2iCFFbPlL3oYlRK
nNVGb9Fa2ttIlP6oFZTbp7Ph0FZ+oSCtmFeDmpjQ5aM5C4WxmfMjs7IDJGup2ZyI
l7X33mQ270NGbKc/k6aCaqMZXyKewDk9bGalULh4dwSZXzNl4sJeb6DarkMyN1gp
SggAGKOsNGVfaGlm5WNTAxRJRZ3dS4UV3ar9UVhblXKO14cm6fKt5ByNBvGTtuy0
h3tR9gbjVjBA5S+iXP7lSb8=
-----END PTFE MIGRATION DATA-----
</code></pre></div><p>The first and last lines will be the same as above but the body will be entirely different. This
is a PEM encoded block that contains the configuration as well as Vault keys to allow
the installer to access your data.</p>
<p>Copy this block of text, including the beginning and ending lines beginning with <code>-----</code>
to your computer&#39;s clipboard by selecting the text and typing Control-C (Windows) or Command-C (macOS).</p>
<h3 id="import-data-into-the-installer-instance">
  <a name="import-data-into-the-installer-instance" class="anchor" href="#import-data-into-the-installer-instance">&raquo;</a>
  Import data into the installer instance
</h3>
<p>To transfer the migration data to the installer-based instance, connect to it over SSH.</p>
<p>Once connected, run the following commands to add the migrator tool to the instance:</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ curl -O https://s3.amazonaws.com/hashicorp-ptfe-data/migrator
$ chmod a+x migrator
</code></pre></div><p>Then, to import the data, run the following command, passing in the same password used
to generate the migration data.</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ sudo ./migrator -password ptfemigrate
</code></pre></div><p>When prompted, paste the data you previously copied to your computer&#39;s clipboard.</p>
<p>The migrator process places the Vault data in the default path for the installer to find,
and outputs the values you&#39;ll need later in the process for the Installer web interface.</p>
<h2 id="installing-ptfe">
  <a name="installing-ptfe" class="anchor" href="#installing-ptfe">&raquo;</a>
  Installing PTFE
</h2>
<p>The installer can run in two modes, Online or Airgapped. Each of these modes has a different way of executing the installer, but the result is the same.</p>
<h3 id="run-the-installer-online">
  <a name="run-the-installer-online" class="anchor" href="#run-the-installer-online">&raquo;</a>
  Run the Installer - Online
</h3>
<p>If your instance can access the Internet, use the Online install mode.</p>

<ol>
<li>From a shell on your instance:

<ul>
<li>To execute the installer directly, run <code>curl https://install.terraform.io/ptfe/stable | sudo bash</code>
</li>
<li>To inspect the script locally before running, run <code>curl https://install.terraform.io/ptfe/stable &gt; install.sh</code> and, once you are satisfied with the script&#39;s content, execute it with <code>sudo bash install.sh</code>.
</li>
</ul>
</li>
<li>The installation will take a few minutes and you&#39;ll be presented with a message
about how and where to access the rest of the setup via the web. This will be
<code>https://&lt;TFE HOSTNAME&gt;:8800</code>

<ul>
<li>The installer uses an internal CA to issue bootstrap certificates, so you will
see a security warning when first connecting. This is expected and you&#39;ll need
to proceed with the connection anyway.
</li>
</ul>
</li>
</ol>
<h3 id="run-the-installer-airgapped">
  <a name="run-the-installer-airgapped" class="anchor" href="#run-the-installer-airgapped">&raquo;</a>
  Run the Installer - Airgapped
</h3>
<p>If the instance cannot reach the Internet, follow these steps to begin an Airgapped installation.</p>
<h4 id="prepare-the-instance">
  <a name="prepare-the-instance" class="anchor" href="#prepare-the-instance">&raquo;</a>
  Prepare the Instance
</h4>

<ol>
<li>Download the <code>.airgap</code> file using the information given to you in your setup email and place that file somewhere on the the instance.

<ul>
<li>If you use are using <code>wget</code> to download the file, be sure to use <code>wget --content-disposition &quot;&lt;url&gt;&quot;</code> so the downloaded file gets the correct extension.
</li>
<li>The url generated for the .airgap file is only valid for a short time, so you may wish to download the file and upload it to your own artifacts repository.
</li>
</ul>
</li>
<li><a href="https://install.terraform.io/airgap/latest.tar.gz">Download the installer bootstrapper</a> and put it into its own directory on the instance (e.g. <code>/opt/tfe-installer/</code>)
</li>
<li>Airgap installations require Docker to be pre-installed. Double check that your instance has a supported version of Docker (see <a href="/docs/enterprise/private/preflight-installer.html#software-requirements">Preflight: Software Requirements</a> above for details).
</li>
</ol>
<h4 id="execute-the-installer">
  <a name="execute-the-installer" class="anchor" href="#execute-the-installer">&raquo;</a>
  Execute the Installer
</h4>
<p>From a shell on your instance, in the directory where you placed the <code>replicated.tar.gz</code> installer bootstrapper:</p>

<ol>
<li>Run <code>tar xzf replicated.tar.gz</code>
</li>
<li>Run <code>sudo ./install.sh airgap</code>
</li>
<li>When asked, select the interface of the primary private network interface used to access the instance.
</li>
<li>The software will take a few minutes and you&#39;ll be presented with a message about how and where to access the rest of the setup via the web. This will be https://<TFE HOSTNAME>:8800

<ul>
<li>The installer uses an internal CA to issue bootstrap certificates, so you will
see a security warning when first connecting. This is expected and you&#39;ll need
to proceed with the connection anyway.
</li>
</ul>
</li>
</ol>
<h3 id="continue-installation-in-browser">
  <a name="continue-installation-in-browser" class="anchor" href="#continue-installation-in-browser">&raquo;</a>
  Continue Installation In Browser
</h3>

<ol>
<li>Configure the hostname and the SSL certificate. <strong>NOTE:</strong> This does not need to be same hostname
that was used by the AMI. It must be a hostname that currently resolves in DNS properly.
</li>
<li>Upload your license file, provided to you in your setup email.
</li>
<li>Indicate whether you&#39;re doing an Online or Airgapped installation. Choose Online if
you&#39;re not sure.

<ul>
<li>If you are doing an Airgapped install, provide the path on the the instance
to the <code>.airgap</code> file that you downloaded using the initial instructions in
your setup email.
</li>
</ul>
</li>
<li>Secure access to the installer dashboard. We recommend at least setting up the
simple password authentication. If you&#39;re so inclined, LDAP authentication can also be
configured.
</li>
<li>The system will now perform a set of pre-flight checks on the instance and
configuration thus far and indicate any failures. You can either fix the issues
and re-run the checks, or ignore the warnings and proceed. If the system is running behind a proxy and is unable to connect to <code>releases.hashicorp.com:443</code>, it is likely safe to proceed; this check does not currently use the proxy. For any other issues, if you proceed despite the warnings, you are assuming the support responsibility.
</li>
<li>Set an encryption password used to encrypt the sensitive information at rest. The default value is auto-generated,
but we strongly suggest you create your own password. Be sure to retain the value, because you will need to use this
password to restore access to the data in the event of a reinstall.
</li>
<li>Select <strong>External Services</strong> under Production Type.
</li>
<li>For the PostgreSQL URL, copy and paste the value that was output by the <code>migrator</code> process for <em>PostgreSQL Database URL</em>.
</li>
<li>Select <strong>S3</strong> under Object Storage.
</li>
<li>Configure the Access Key ID and Secret Access Key, <em>OR</em> indicate that you want to use an instance profile.
<strong>NOTE</strong>: An instance profile must be previously configured on the instance.
</li>
<li>For the Bucket, copy and paste the value that was output by the <code>migrator</code> process for <em>S3 Bucket</em>.
</li>
<li>For the Region, copy and paste the value that was output by the <code>migrator</code> process for <em>S3 Region</em>.
</li>
<li>For the Server-side Encryption, copy and paste the value that was output by the <code>migrator</code> process for the server-side encryption.
</li>
<li>For the KMS key, copy and paste the value that was output by the <code>migrator</code> process for <em>Optional KMS key</em>. <strong>NOTE:</strong> This key is not optional for migration, as it is used to read all the data in S3.
</li>
<li><em>Optional:</em> Adjust the concurrent capacity of the instance. This should
only be used if the hardware provides more resources than the baseline
configuration and you wish to increase the work that the instance does
concurrently. This setting should be adjusted with care as setting it too
high can result in an very unresponsive instance.
</li>
<li><em>Optional:</em> Provide the text version of a certificate (or certificates) that will be added to the trusted
list for the product. This is used when services the product communicates with do not use
globally trusted certificates but rather a private Certificate Authority (CA). This is typically
used when Private Terraform Enterprise uses a private certificate (it must trust itself) or a
VCS provider uses a private CA.
</li>
</ol>
<h3 id="finish-installing">
  <a name="finish-installing" class="anchor" href="#finish-installing">&raquo;</a>
  Finish Installing
</h3>
<p>Once configured, the software will finish downloading. When it’s ready, the UI
will indicate so and there will be an Open link to click to access the Terraform Enterprise UI.</p>
<h2 id="access">
  <a name="access" class="anchor" href="#access">&raquo;</a>
  Access
</h2>
<p>You can now access your PTFE installation using the previously configured hostname.</p>
<h2 id="cleanup">
  <a name="cleanup" class="anchor" href="#cleanup">&raquo;</a>
  Cleanup
</h2>
<p>Now that the installer is using a subset of resources created by the AMI cluster Terraform configuration,
we need to move those resources from the Terraform state for the AMI cluster.</p>
<p>If these resources are not moved, it&#39;s possible to accidentally delete the data when the AMI
cluster is removed!</p>
<div class="alert alert-warning" role="alert">
<p><strong>NOTE:</strong> If you have modified the Terraform modules we have provided, you&#39;ll need to adapt these instructions
   to fit your modifications.</p>
</div>
<h3 id="move-to-new-terraform-state">
  <a name="move-to-new-terraform-state" class="anchor" href="#move-to-new-terraform-state">&raquo;</a>
  Move to new Terraform state
</h3>
<p>First, verify all the resources currently tracked in the Terraform state. If the <code>terraform.tfstate</code> file is on
your local disk, change to that directory. Next, list the state:</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>terraform state list
aws_caller_identity.current
aws_kms_alias.key
aws_kms_key.key
aws_subnet.instance
aws_vpc.vpc
module.db.aws_db_instance.rds
module.db.aws_db_subnet_group.rds
module.db.aws_security_group.rds
module.instance.aws_autoscaling_group.ptfe
module.instance.aws_ebs_volume.data[0]
module.instance.aws_ebs_volume.data[1]
module.instance.aws_elb.ptfe
module.instance.aws_iam_instance_profile.tfe_instance
module.instance.aws_iam_policy_document.tfe-perms
module.instance.aws_iam_role.tfe_iam_role
module.instance.aws_iam_role_policy.tfe-perms
module.instance.aws_launch_configuration.ptfe
module.instance.aws_s3_bucket.tfe_bucket
module.instance.aws_s3_bucket_object.setup
module.instance.aws_security_group.ptfe
module.instance.aws_security_group.ptfe-external
module.instance.aws_subnet.subnet
module.route53.aws_route53_record.rec
random_id.installation-id
</code></pre></div><p>Of these resources, the ones to move from the state so they are can exist outside this Terraform configuration are:</p>
<div class="highlight"><pre class="highlight plaintext"><code>aws_kms_alias.key
aws_kms_key.key
module.db.aws_db_instance.rds
module.db.aws_db_subnet_group.rds
module.db.aws_security_group.rds
module.instance.aws_s3_bucket.tfe_bucket
</code></pre></div><p>To move these resources from the state into a new state file for later use, run:</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>terraform state mv <span class="nt">-state-out</span><span class="o">=</span>terraform.tfstate.installer aws_kms_alias.key aws_kms_alias.key
<span class="nv">$ </span>terraform state mv <span class="nt">-state-out</span><span class="o">=</span>terraform.tfstate.installer aws_kms_key.key aws_kms_key.key
<span class="nv">$ </span>terraform state mv <span class="nt">-state-out</span><span class="o">=</span>terraform.tfstate.installer module.db.aws_db_instance.rds module.db.aws_db_instance.rds
<span class="nv">$ </span>terraform state mv <span class="nt">-state-out</span><span class="o">=</span>terraform.tfstate.installer module.db.aws_db_subnet_group.rds module.db.aws_db_subnet_group.rds
<span class="nv">$ </span>terraform state mv <span class="nt">-state-out</span><span class="o">=</span>terraform.tfstate.installer module.db.aws_security_group.rds module.db.aws_security_group.rds
<span class="nv">$ </span>terraform state mv <span class="nt">-state-out</span><span class="o">=</span>terraform.tfstate.installer module.instance.aws_s3_bucket.tfe_bucket module.instance.aws_s3_bucket.tfe_bucket
</code></pre></div><h3 id="destroy-ami-cluster">
  <a name="destroy-ami-cluster" class="anchor" href="#destroy-ami-cluster">&raquo;</a>
  Destroy AMI Cluster
</h3>
<p>Now that these resources have been moved out of the AMI state, it&#39;s safe to destroy the AMI cluster
without affecting the installer-based installation.</p>
<p>If you&#39;re ready to perform that step, run:</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>terraform destroy
</code></pre></div><p>You&#39;ll be asked to confirm the resources to be destroyed, and should double-check that the list doesn&#39;t contain the
resources moved earlier.</p>
<h3 id="managing-installer-resources">
  <a name="managing-installer-resources" class="anchor" href="#managing-installer-resources">&raquo;</a>
  Managing Installer Resources
</h3>
<p>To continue to manage the resources used by the Installer-based install using Terraform, you can move the resources
in the new <code>terraform.tfstate.installer</code> file to a large state file, along with the Terraform modules for them.</p>


    </div>
  </div>
</div>


    <div id="footer" class="navigation hidden-print">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <ul class="footer-links nav navbar-nav">
              <li><a href="/intro/index.html">Intro</a></li>
              <li><a href="/docs/index.html">Docs</a></li>
              <li><a href="/docs/extend/index.html">Extend</a></li>
              <li><a href="https://www.hashicorp.com/privacy">Privacy</a></li>
              <li><a href="/security.html">Security</a></li>
              <li><a href="/assets/files/press-kit.zip">Press Kit</a></li>
            </ul>
            <ul class="footer-links nav navbar-nav navbar-right">
              <li><a href="https://github.com/hashicorp/terraform-website">Edit this page</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Product",
        "name": "Terraform",
        "alternateName": "Terraform by HashiCorp",
        "manufacturer": "HashiCorp",
        "url": "https://www.terraform.io",
        "logo": "/../../../assets/images/logo-hashicorp-3f10732f.svg",
        "sameAs": [
          "https://github.com/hashicorp/terraform"
        ]
      }
    </script>
  </body>
</html>
